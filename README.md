# Pandoc HTML+PDF Pipeline

This repo uses pandoc to compile to both the Programming conference proceedings format, and an online essay.

The goal is to keep both versions in sync as closely as possible and avoid divergences.

## Compile

[Install pandoc](https://pandoc.org/installing.html)

Install `paru` for ruby: `sudo gem install paru`. (May require a ruby upgrade)

Install browsersync: `npm install -g browser-sync`

To view HTML with a live preview: `./watch.sh`

To compile to HTML (including copying assets to my personal homepage dir): `./compile-html.sh`
To compile to PDF through Latex: `./compile-latex.sh && open paper.pdf`

## notes

* To allow `pandoc-crossref` to run on Mac you may need to manually allow it in security settings.

* image sizes and Latex output interact weirdly. I use high-res pngs exported from Sketch at 72dpi, and then in the latex compile script I use ImageMagick to convert to 300dpi so that the final size comes out correctly in the pdf.

* (unfortunately) there are two separate reference files which both need to be kept updated. `references-bibtex.bib` is in BibTex format, used for the PDF output, where the bibliography is generated by the ACM template. `references-biblatex.bib` is in BibLatex format, used for the html output, which includes a pandoc-generated bibliography. As far as I can tell, this is the only way to get full desird bibliography info on both outputs -- BibLatex in PDF doesn't show dates, and BibTex in HTML doesn't show URLs for websites. There may be a better solution here but that's what we do for now.
